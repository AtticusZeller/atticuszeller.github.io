---
allow-lan: true
# https://wiki.metacubex.one/config/dns/
# https://gist.github.com/liuran001/5ca84f7def53c70b554d3f765ff86a33
dns:
  default-nameserver:
    - 223.5.5.5
    - 223.6.6.6
    - '[2402:4e00::]'
    - '[2400:3200::1]'
  enable: true
  enhanced-mode: fake-ip
  fake-ip-filter:
    - '*.lan'
    - +.local
  fake-ip-filter-mode: blacklist
  ipv6: true
  listen: 0.0.0.0:53
  # cloudflare DoT and DoH
  nameserver:
    - tls://1.1.1.1
    - tls://1.0.0.1
    - tls://[2606:4700:4700::1111]
    - tls://[2606:4700:4700::1001]
    - https://1.1.1.1/dns-query
    - https://1.0.0.1/dns-query
    - https://[2606:4700:4700::1111]/dns-query
    - https://[2606:4700:4700::1001]/dns-query
  nameserver-policy:
    geosite:cn,private:
      - https://223.5.5.5/dns-query
      - https://223.6.6.6/dns-query
  prefer-h3: true
external-controller: 127.0.0.1:9097
external-controller-cors:
  allow-origins:
    - '*'
  allow-private-network: true
geo-auto-update: true
geo-update-interval: 24
geodata-loader: standard
# https://wiki.metacubex.one/config/general/#geo
geodata-mode: true
geox-url:
  asn: https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/GeoLite2-ASN.mmdb
  geoip: https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/geoip.dat
  geosite: https://github.com/Loyalsoldier/domain-list-custom/releases/latest/download/geosite.dat
  mmdb: https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/Country.mmdb
global-client-fingerprint: firefox
ipv6: true
# https://github.com/vernesong/OpenClash/issues/2614
keep-alive-interval: 60
log-level: info
mixed-port: 45629
# https://wiki.metacubex.one/config/general/
mode: rule
profile:
  store-fake-ip: true
  store-selected: true
proxy-groups:
  - name: 🔰 Node
    proxies:
      - ♻️ Auto-tcp
      - ♻️ Auto-ws
      - ☁️ Cloudflare
      - 🎯 Direct
    type: select
  - include-all-proxies: true
    interval: 300
    lazy: true
    name: ♻️ Auto-tcp
    type: url-test
    url: https://cp.cloudflare.com
    use:
      - vless-tcp-xtls-vision
  - include-all-proxies: true
    interval: 300
    lazy: true
    name: ♻️ Auto-ws
    type: url-test
    url: https://cp.cloudflare.com
    use:
      - vless-ws-tls-cdn
  - include-all-proxies: true
    interval: 300
    lazy: true
    name: ☁️ Cloudflare
    type: url-test
    url: https://cp.cloudflare.com
    use:
      - vless-ws-cdn-worker
  - name: 🎯 Direct
    proxies:
      - DIRECT
      - ♻️ Auto-tcp
      - ♻️ Auto-ws
      - ☁️ Cloudflare
    type: select
  - name: 🐟 Remaining
    proxies:
      - 🔰 Node
      - 🎯 Direct
    type: select
  - name: 🍎 Apple
    proxies:
      - 🎯 Direct
      - 🔰 Node
    type: select
  - name: 📲 Telegram
    proxies:
      - 🔰 Node
      - 🎯 Direct
    type: select
  - name: ⛔️ Ads
    proxies:
      - REJECT
      - 🎯 Direct
      - 🔰 Node
    type: select
# https://wiki.metacubex.one/config/proxy-providers/
proxy-providers:
  vless-tcp-xtls-vision:
    interval: 86400
    override:
      mptcp: true
      skip-cert-verify: true
      tfo: true
      udp: true
    path: ./proxy_providers/vps-tcp.yaml
    proxy: DIRECT
    type: http
    url: https://raw.atticuszeller.club/AtticusZeller/atticuszeller.github.io/refs/heads/main/atticuszeller/CS/OS/Proxy/vless-tcp-xtls-vision.yml
  vless-ws-cdn-worker:
    interval: 86400
    override:
      mptcp: true
      skip-cert-verify: true
      tfo: true
      udp: false
    path: ./proxy_providers/cdn.yaml
    proxy: DIRECT
    type: http
    url: https://raw.atticuszeller.club/AtticusZeller/atticuszeller.github.io/refs/heads/main/atticuszeller/CS/OS/Proxy/vless-ws-cdn-worker.yml
  vless-ws-tls-cdn:
    interval: 86400
    override:
      mptcp: true
      skip-cert-verify: true
      tfo: true
      udp: true
    path: ./proxy_providers/vps-ws.yaml
    proxy: DIRECT
    type: http
    url: https://raw.atticuszeller.club/AtticusZeller/atticuszeller.github.io/refs/heads/main/atticuszeller/CS/OS/Proxy/vless-ws-tls-cdn.yml
# https://github.com/Loyalsoldier/clash-rules
# https://wiki.metacubex.one/config/rule-providers/
rule-providers:
  apple:
    behavior: domain
    interval: 86400
    path: ./ruleset/apple.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt
  applications:
    behavior: classical
    interval: 86400
    path: ./ruleset/applications.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt
  cncidr:
    behavior: ipcidr
    interval: 86400
    path: ./ruleset/cncidr.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt
  direct:
    behavior: domain
    interval: 86400
    path: ./ruleset/direct.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt
  icloud:
    behavior: domain
    interval: 86400
    path: ./ruleset/icloud.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt
  lancidr:
    behavior: ipcidr
    interval: 86400
    path: ./ruleset/lancidr.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt
  private:
    behavior: domain
    interval: 86400
    path: ./ruleset/private.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt
  proxy:
    behavior: domain
    interval: 86400
    path: ./ruleset/proxy.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt
  telegramcidr:
    behavior: ipcidr
    interval: 86400
    path: ./ruleset/telegramcidr.yaml
    type: http
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt
rules:
  # web panel
  - DOMAIN,metacubexd.pages.dev,🎯 Direct
  # local and private
  - RULE-SET,lancidr,🎯 Direct,no-resolve
  - RULE-SET,private,🎯 Direct
  # global
  - GEOSITE,category-dev,🔰 Node
  - RULE-SET,telegramcidr,📲 Telegram,no-resolve
  - RULE-SET,proxy,🔰 Node
  # apple available in china
  - RULE-SET,icloud,🍎 Apple
  - RULE-SET,apple,🍎 Apple
  # Chinese domains and IPS
  - RULE-SET,direct,🎯 Direct
  - RULE-SET,cncidr,🎯 Direct,no-resolve
  - GEOIP,LAN,🎯 Direct,no-resolve
  - GEOIP,CN,🎯 Direct,no-resolve
  - GEOSITE,cn,🎯 Direct
  # Reject
  - GEOSITE,category-porn,⛔️ Ads
  - GEOSITE,category-ads-all,⛔️ Ads
  - MATCH,🐟 Remaining
secret: ''
# https://wiki.metacubex.one/config/sniff/
sniffer:
  enable: true
  force-dns-mapping: true
  override-destination: true
  parse-pure-ip: true
  sniff:
    HTTP:
      override-destination: true
      ports: [80, 8080-8880]
    QUIC:
      ports: [443, 8443]
    TLS:
      ports: [443, 8443]
tcp-concurrent: true
tun:
  auto-detect-interface: true
  auto-route: true
  device: Meta
  dns-hijack:
    - any:53
  enable: true
  mtu: 9000
  stack: gvisor
  strict-route: true
unified-delay: true
# GEOSITE https://github.com/v2fly/domain-list-community/tree/master
